/*
 * -------------------------------------------------
 * Juno config
 * -------------------------------------------------
 * Pipeline parameters specific to running Tempo with LSF on the Juno cluster at MSKCC
 * -------------------------------------------------
 */

executor {
  name = "lsf"
  queueSize = 5000
  perJobMemLimit = true
}

params {

  // Limit resources so that this can run CI
  max_cpus   = 10
  max_memory = 40.GB
  max_time   = 240.h
  maxErrorRetry = 3
}

params.mem_per_core = true

process {

    withName: 'MEDICC_SITKA_SIM:CONVERT_SITKA_TREE' {
            time = 2.h
            memory = 32.GB
            cpus = 1
        }
    withName: 'MEDICC_SITKA_SIM:RUN_MEDICC_WITH_TREE' {
        time = { 32.h + 48.h * (task.attempt - 1) }
        memory = { 64.GB * task.attempt }
        cpus = 1
        errorStrategy = 'retry'
        maxErrors = 0 // 100
        maxRetries = 0 // 3
    }
    withName: 'MEDICC_SITKA_SIM:PLOT_MEDICC_RESULTS' {
        time = 2.h
        memory = 32.GB
        cpus = 1
    }
    
}

